<!DOCTYPE html>
<html>
<head>
    <title>SVG GANTT Test</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }
        #gantt-chart-container {
            position: relative;
            min-height: 200px;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 15px;
        }
        .phase-bar {
            cursor: pointer;
            transition: opacity 0.2s ease;
        }
        .phase-bar:hover {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <h1>SVG GANTT Test Page</h1>
    
    <div id="gantt-chart-container">
        <!-- SVG will be inserted here -->
    </div>
    
    <button onclick="testRender()">Render GANTT</button>
    <button onclick="testExport()">Export as PNG</button>
    
    <div id="status"></div>
    
    <script src="/static/js/svg-gantt.js"></script>
    <script>
        // Test data
        const testIdeaData = {
            id: 1,
            size: 'medium',
            status: 'claimed',
            subStatus: 'in_development',
            progress: 30,
            dateSubmitted: new Date('2025-01-01'),
            neededBy: new Date('2025-02-01'),
            claimDate: new Date('2025-01-05'),
            linkedItems: {
                comments: 5,
                links: 3,
                activities: 10
            }
        };
        
        let ganttChart = null;
        
        function testRender() {
            const status = document.getElementById('status');
            try {
                status.innerHTML = '<p>Rendering SVG GANTT...</p>';
                
                ganttChart = new SVGGanttChart('gantt-chart-container', testIdeaData);
                ganttChart.render();
                window.currentGanttChart = ganttChart;
                
                status.innerHTML = '<p style="color: green;">✓ SVG GANTT rendered successfully!</p>';
                
                // Check what was created
                const svg = document.getElementById('gantt-svg');
                if (svg) {
                    const groups = svg.querySelectorAll('g').length;
                    const phases = svg.querySelectorAll('.phase').length;
                    status.innerHTML += `<p>Created: ${groups} groups, ${phases} phases</p>`;
                }
            } catch (error) {
                status.innerHTML = `<p style="color: red;">✗ Error: ${error.message}</p>`;
                console.error('Full error:', error);
            }
        }
        
        function testExport() {
            if (ganttChart && ganttChart.exportAsPNG) {
                ganttChart.exportAsPNG();
            } else {
                alert('Please render the GANTT first');
            }
        }
        
        // Auto-render on load
        window.addEventListener('load', function() {
            setTimeout(testRender, 100);
        });
    </script>
</body>
</html>